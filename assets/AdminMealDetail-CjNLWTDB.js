import{_ as M}from"./ConfirmBtn-Bio-Qf65.js";import{u as D,_ as N}from"./showStore-m6tnM1e-.js";import{_ as F}from"./CheckInput-B3X8O6x1.js";import{_ as U,u as j,h as u,c as g,d as o,e as s,F as C,l as P,w as E,t as L,q,k as R,f as a,r as V,a as T,o as X,s as z,L as G,i as H}from"./index-BjlnAQqZ.js";import{_ as J}from"./DropDown-FOo6tuF-.js";import{_ as K}from"./AdminUploadImg-BrfQD7np.js";import{c as B,b as Q}from"./User-CfpT1Yns.js";import{c as W,d as Y}from"./Admin-CYE_-21Z.js";import{u as Z}from"./imageStore-fQkg73oQ.js";const ee={class:"form__text-grid"},oe={class:"d-flex justify-content-between align-items-center mb-2"},te={key:0,class:"content"},ne=["onClick"],se={class:"popup__text-content"},ae={__name:"AddAlter",props:{allOption:{type:Object,required:!1}},setup(w){const _=w,f=j(),n=D(),c=()=>{n.togglePopupShow("option",!0)},m=()=>{n.togglePopupShow("option",!1)},v=i=>{f.pluralOption("option",i)},b=()=>f.choice.option?_.allOption[0].children.filter(i=>f.choice.option.includes(i.id)):!1;return(i,p)=>{const y=M,k=F,x=N;return u(),g(C,null,[o("div",ee,[o("div",oe,[p[1]||(p[1]=o("label",{for:"alter",class:"form__text-label"},"新增自訂項目",-1)),s(y,{styles:["brown","small-button"],class:"ms-auto",iconName:"Common-Add",title:"添加自訂項目",onClick:c})]),o("div",{class:"form__text-tag mb-3",onClick:c},[b()?(u(),g("div",te,[(u(!0),g(C,null,P(b(),h=>(u(),g("div",{onClick:p[0]||(p[0]=E(()=>{},["stop"])),key:h.id},[o("span",null,L(h.name),1),o("button",{onClick:O=>v(h.id)},"X",8,ne)]))),128))])):q("",!0)])]),s(x,{show:a(n).popupShow.option,title:"添加自訂項目",button:"確認",onCloseShow:m,onConfirmPopup:m,style:{width:"30rem",height:"30rem"}},{main:R(()=>[o("div",se,[s(k,{style:{padding:"0"},option:w.allOption,basic:{type:"select",noValid:"true"}},null,8,["option"])])]),_:1},8,["show"])],64)}}},ie=U(ae,[["__scopeId","data-v-c1c6edbb"]]),re={class:"form__frame gap-3"},ce={class:"form__container"},le={method:"post",enctype:"multipart/form-data"},me={class:"form__UploadImg"},de={class:"check__inputBox"},pe={class:"form__container new__menu-content check__inputBox"},ue={class:"form__add-controller"},_e={__name:"AdminMealDetail",props:{data:{type:Object,required:!1}},setup(w){const _=w,f=V([...Y]),n=D(),c=j(),m=Z(),v=T(),b=G(),i=V({drop:"meal",active:!0}),p=[{id:"name",message:"請輸入正確名稱。"},{id:"price",message:"請輸入正確價錢。"},{id:"count",message:"請輸入正確數量。"}],y=()=>{const t={name:"",price:"",description:"",count:"",status:1};return delete t.option,t},k=()=>{const t=B.find(S=>S.name===_.data.name);n.meal=t;const{name:e,price:l,description:r,count:d,option:I}=_.data.children;Object.assign(c.choice,{name:e,price:l,description:r,count:d,status:1,option:I})},x=()=>{c.clearError();const t=p.map(r=>c.validateInput(r.id,r.name,r.message)),e=m.validateImage(),l=n.validateDropdown(n.meal,"餐點分類");return!(t.includes(!1)||!e||!l)},h=t=>{const e=Q.find(l=>l.id===t.menuId);e&&(e.children.find(r=>r.name===t.name)||e.children.push({...t,id:e.children.length}))},O=()=>{if(!x())return;console.log(n.meal.id);let t={menuId:n.meal.id,image:m.localUploadImg||m.uploadImg,...c.choice};h(t),v.pushMsg("Common-Ok","送出成功","brown"),H.push({name:"AdminMeal"})};return X(()=>{c.choice=y(),n.theme="",b.query.id?k():m.clearImage()}),(t,e)=>{var $;const l=K,r=J,d=F,I=ie,S=M;return u(),g(C,null,[o("article",re,[o("div",ce,[o("form",le,[o("div",me,[s(l,{image:($=_.data)==null?void 0:$.children.image},null,8,["image"])])]),o("div",de,[e[2]||(e[2]=o("h6",{class:"form__text-label"},"餐點分類",-1)),a(i)!==null?(u(),z(r,{key:0,modelValue:a(n)[a(i).drop],"onUpdate:modelValue":e[0]||(e[0]=A=>a(n)[a(i).drop]=A),data:a(B),dropdown:a(i)},null,8,["modelValue","data","dropdown"])):q("",!0),s(d,{regex:/^.+$/,basic:{type:"input",id:"name",name:"名稱"}}),s(d,{regex:/^[0-9]+$/,basic:{type:"input",id:"price",name:"價錢"}}),s(d,{regex:/^[0-9]+$/,basic:{type:"input",id:"count",name:"數量"}})])]),o("div",pe,[s(d,{basic:{type:"textarea",id:"description",name:"說明"}}),s(d,{style:{padding:"0",marginTop:"1rem"},option:a(f),basic:{type:"select"}},null,8,["option"]),s(I,{allOption:a(W)},null,8,["allOption"])])]),o("div",ue,[s(S,{styles:["brown"],class:"ms-auto",title:"確認",onClick:e[1]||(e[1]=A=>O())})])],64)}}},Ie=U(_e,[["__scopeId","data-v-d645aa80"]]);export{Ie as default};
